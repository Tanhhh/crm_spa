@using Erp.BackOffice.App_GlobalResources
@using Erp.BackOffice.Helpers
@using Erp.BackOffice.Sale.Models
@using Erp.BackOffice.Areas.Cms.Models
@model  CategoryViewModel

@{
    Layout = null;
    var data = Erp.BackOffice.Helpers.SelectListHelper.GetAllProductAndService();
    var productList = ViewBag.productList;
}

<div class="product-search-box clearfix " style="margin-bottom:10px">
    <span class="label label-warning" style="padding: 6px; float: left; height: 35px;margin-left:0px">[F4]</span>
    <div id="product_search_control">
        <span class="ctl">
            @*@Html.TextBox("ProductName", "", new { placeholder = "Sản phẩm/Dịch vụ...", autocomplete = "off", style = "width:300px; margin-right:0px" })*@
            <select id="productSelectList" name="productSelectList" style="width:30%;">
                <option value="">Tìm Sản phẩm/Dịch vụ...</option>
                @foreach (var item in productList)
                {
                    foreach (var a in data.Where(x => x.Id == item.Id))
                    {
                        <option value="@a.Id" data-selected="0" data-value="@a.Id | @(Common.KiemTraTonTaiHinhAnh(item.Image_Name, "product-image-folder", "product"))  | @(item.Code + " - " + item.Name)" data-code="@item.Code" data-barcode="@item.Barcode" @*data-question-id="@a.QuestionId"*@ data-target-module="Product" data-target-id="@a.Id">@item.Code - @item.Name</option>
                    }
                }
            </select>
        </span>
    </div>
</div>

<div id="discount" class="tab-pane active table-responsive ">
    @Html.Action("LoadAdviseCard", "AdviseCard", new { @AdviseCardId = ViewBag.AdviseCard })

</div>

@*<table class="table table-responsive table-bordered">
    <thead>
        <tr>
            <td style="width:5%"></td>
            @foreach (var ii in Model.ListQuestion)
            {
                <td style="width: 30%">@ii.Name</td>
            }
            <td style="width: 35%">Ghi chú</td>
        </tr>
    </thead>
    <tbody>
        @foreach (var i in data.GroupBy(x => x.CategoryCode))
        {
            <tr>
                <td style="width:5%">@i.Key</td>
                @foreach (var question in Model.ListQuestion)
                {
                    if (question.Name == "SẢN PHẨM")
                    {
                        <td>
                            <div class="answer">
                                @foreach (var ii in data.Where(x => x.CategoryCode == i.Key && x.Type == "product"))
                                {
                                    <label style="margin-right:30px !important">
                                        <input name="TargetId_@(question.Id)_@ii.Id" type="checkbox" class="ace" data-question-id="@question.Id" data-target-module="Product" data-target-id="@ii.Id" value="@ii.Id" />
                                        <span class="lbl"> @ii.Name</span>
                                    </label>
                                }
                            </div>
                        </td>
                    }
                    if (question.Name == "DỊCH VỤ")
                    {
                        <td>
                            <div class="answer">
                                @foreach (var ii in data.Where(x => x.CategoryCode == i.Key && x.Type == "service"))
                                {
                                    <label style="margin-right:30px !important">
                                        <input name="TargetId_@(question.Id)_@ii.Id" type="checkbox" class="ace" data-question-id="@question.Id" data-target-module="Product" data-target-id="@ii.Id" value="@ii.Id" />
                                        <span class="lbl"> @ii.Name</span>
                                    </label>
                                }
                            </div>
                        </td>
                        <td>
                            <textarea class="" id="Content_@(question.Id)_0" data-question-id="@question.Id" data-target-module="Answer" data-target-id="0"></textarea>
                        </td>
                    }

                }
            </tr>
        }

    </tbody>
</table>*@

