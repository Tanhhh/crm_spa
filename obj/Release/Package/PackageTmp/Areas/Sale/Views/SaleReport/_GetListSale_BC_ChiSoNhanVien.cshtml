@using Erp.BackOffice.App_GlobalResources
@using Erp.BackOffice.Sale.Models
@using Erp.BackOffice.Helpers
@using Erp.BackOffice.Areas.Sale.Models
@model List<ChiSoNhanVienViewModel>

    @{
        Layout = null;
        int index = 1;
    }

    <table id="cTable" class="table table-bordered">
        <thead>
            <tr class="" style="display:none">
                <th class="" colspan="10" style="text-align:center"><h4>Báo cáo chỉ số nhân viên trong thời gian lựa chọn</h4></th>
            </tr>
            <tr>
                <th style="width:40px;text-align:center">STT</th>
                <th style="width:100px;text-align:center">Nhân Viên</th>
                <th style="width:200px;text-align:center">Nguồn khách mới</th>
                <th style="width:100px;text-align:center">SL lên mới</th>
                <th style="width:150px;text-align:center">SL mua mới</th>
                <th style="width:100px;text-align:center">DS ảo ORLANE mới</th>
                <th style="width:100px;text-align:center">DS thực ORLANE mới</th>
                <th style="width:100px;text-align:center">TB DS ORLANE ảo mới</th>
                <th style="width:100px;text-align:center">Trung bình DS ORLANE thực mới</th>
                <th style="width:100px;text-align:center">SL hẹn cũ</th>
                <th style="width:100px;text-align:center">SL lên cũ</th>
                <th style="width:100px;text-align:center">SL mua cũ</th>
                <th style="width:100px;text-align:center">DS ảo ORLANE cũ</th>
                <th style="width:100px;text-align:center">DS thực ORLANE cũ</th>
                <th style="width:100px;text-align:center">Trung bình DS ORLANE ảo cũ</th>
                <th style="width:100px;text-align:center">Trung bình DS ORLANE thực cũ</th>
                <th style="width:100px;text-align:center">Tổng ảo ORLANE</th>
                <th style="width:100px;text-align:center">Tổng thực ORLANE NVKD</th>
                <th style="width:100px;text-align:center">DS ảo ANNAYAKE</th>
                <th style="width:100px;text-align:center">DS thực ANNAYAKE</th>
                <th style="width:100px;text-align:center">DS ảo LEONOR GREYL</th>
                <th style="width:100px;text-align:center">DS thực LEONOR GREYL</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
               
                <tr class="@(index%2==0?"alert-warning":"")">
                    <td>
                        <span>@(index++)</span>
                    </td>
                    <td>@item.ManagerStaffName</td>
                    <td>@item.NguonKhach</td>
                    <td>@item.SLLenMoi</td>
                    <td>@item.SLMuaMoi</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSAoOrlaneMoi, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSThucOrlaneMoi, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.TBDSOrlaneAoMoi, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.TBDSOrlaneThucMoi, null))</td>
                    <td>@item.SLHenCu</td>
                    <td>@item.SLLenCu</td>
                    <td>@item.SLMuaCu</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSAoOrlaneCu, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSThucOrlaneCu, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.TBDSOrlaneAoCu, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.TBDSOrlaneThucCu, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.TongAoOrlane, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.TongThucOrlaneNVKD, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSAoAnnayake, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSThucAnnayake, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSAoLeonorGreyl, null))</td>
                    <td>@(CommonSatic.ToCurrencyStr(item.DSThucLeonorGreyl, null))</td>
                   

                </tr>
            }
        </tbody>
        <thead>
            <tr>

                <td colspan="3" style="text-align:left"><b>Tổng:</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.SLLenMoi), null))</b></td>
                <td style="text-align:left"><b>@(Common.PhanCachHangNgan2(Model.Sum(x => x.SLMuaMoi)))</b></td>
                <td style="text-align:left"><b>@(Common.PhanCachHangNgan2(Model.Sum(x => x.DSAoOrlaneMoi)))</b></td>
                <td style="text-align:left"><b>@(Common.PhanCachHangNgan2(Model.Sum(x => x.DSThucOrlaneMoi)))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(@ViewBag.TBAoMoi, null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(@ViewBag.TBThucMoi, null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.SLHenCu), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.SLLenCu), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.SLMuaCu), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.DSAoOrlaneCu), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.DSThucOrlaneCu), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(@ViewBag.TBAoCu, null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(@ViewBag.TBThucCu, null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.TongAoOrlane), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.TongThucOrlaneNVKD), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.DSAoAnnayake), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.DSThucAnnayake), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.DSAoLeonorGreyl), null))</b></td>
                <td style="text-align:left"><b>@(CommonSatic.ToCurrencyStr(Model.Sum(x => x.DSThucLeonorGreyl), null))</b></td>
            </tr>
        </thead>

        @*<thead>
                <tr>
                    <td colspan="9" style="text-align:right"><b>Tổng</b></td>
                    <td style="text-align:right">@(Common.PhanCachHangNgan2(Model.Sum(x => x.Quantity)))</td>
                </tr>
            </thead>*@
</table>
    <script src="~/Scripts/jquery.floatThead.js"></script>
    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
            $("#CTable").floatThead({ top: 30 });
        });
    </script>
