
    @using Erp.BackOffice.App_GlobalResources
    @using Erp.BackOffice.Crm.Models
    @using Erp.BackOffice.Helpers
    @using GridMvc.Html

    @{
        ViewBag.Title = Wording.PageIndex_SMSLog;
        bool isPopup = Request["popup"] != null && Request["popup"].ToString().ToLower() == "true" ? true : false;
        if (isPopup)
        {
            Layout = "~/Views/Shared/_PopupLayout.cshtml";
        }
        else
        {
            Layout = "~/Views/Shared/ACE_AdminLayout.cshtml";
        }
        Erp.BackOffice.Models.PageSetting pageSetting = new Erp.BackOffice.Models.PageSetting
        {
            ModuleName = "Campaign",
            ActionName = "ShowHistory",
            PageTitle = ViewBag.Title,
            DisplaySearchPanel = true,
            IsPopup = false,
            DisplayBackButton = false,

        };
    }
    <link href="@Url.Content("~/assets/css/Gridmvc.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/gridmvc.min.js")" type="text/javascript"></script>


    @helper GridColumnName(string Name)
    {
        <b>@Name</b>
    }
    @helper GridColumnName(int Count)
    {
        <b>@Count</b>
    }
<style>
    .display-selected {
        background-color: #337ab7 !important;
    }
</style>

<div class="container-fluid">
    <div class="row " style="display:flex;align-items:end;">
        <div class="col-md-3" style="display:flex;height:100%;">

            <button class="btn btn-mini btn-info form-control display-selected" type="button" onclick="ShowSMSCampaignLog()" id="showSms">SMS</button>
            <button class="btn btn-mini btn-info form-control" type="button" onclick="ShowEmailCampaignLog()" id="showEmail">Email</button>
            <button class="btn btn-mini btn-info form-control" type="button" onclick="ShowZaloCampaignLog()" id="showZns">Zalo</button>

        </div>
        <div class="col-md-4">
            <div class="row">
                <div class="col-md-6">
                    <label>Ngày bắt đầu: </label>
                    <input type="date" id="filterStartDate" class="form-control">
                </div>

                <div class="col-md-6">
                    <label>Ngày kết thúc: </label>
                    <input type="date" id="filterEndDate" class="form-control">
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <label>Lọc theo tên: </label>
            <input type="text" id="filterName" class="form-control">
        </div>
        <div class="col-md-1">
            <button class="btn btn-mini btn-primary form-control" type="button" onclick="CampaignFilter()">Lọc</button>
        </div>
    </div>
    <hr />
    <div class="row">
        <div class="col-md-12">
            <div id="CampaignHistoryTable">
            </div>
        </div>
    </div>
</div>
    

    <script>
        var smsTblDisplay = true;
        var emailTblDisplay = false;
        var znsTblDisplay = false;
        $(document).ready(function () {
            ShowLoading();
            $.ajax({
                url: "/Campaign/GetHistoryList?" + '&StartDate= ' + '&EndDate= ' + '&nameFilter= ',
                method: "GET",
                dataType: 'html',
                success: function (data) {
                    $('#CampaignHistoryTable').html(data);
                }
            });
            HideLoading();
        })
        function ShowSMSCampaignLog() {
            smsTblDisplay = true;
            emailTblDisplay = false;
            znsTblDisplay = false;
            $('#showSms').addClass('display-selected');
            $('#showEmail').removeClass('display-selected');
            $('#showZns').removeClass('display-selected');
            $('#showSms').blur();
            

        }
        function ShowEmailCampaignLog() {
            smsTblDisplay = false;
            emailTblDisplay = true;
            znsTblDisplay = false;

            $('#showEmail').addClass('display-selected');
            $('#showSms').removeClass('display-selected');
            $('#showZns').removeClass('display-selected');
            $('#showEmail').blur();
        }
        function ShowZaloCampaignLog() {
            smsTblDisplay = false;
            emailTblDisplay = false;
            znsTblDisplay = true;

            $('#showZns').addClass('display-selected');
            $('#showEmail').removeClass('display-selected');
            $('#showSms').removeClass('display-selected');
            $('#showZns').blur();
        }
        function CampaignFilter() {
            var startDate = $("#filterStartDate").val();
            var endDate = $("#filterEndDate").val();
            var nameFilter = $('#filterName').val();
            $.ajax({
                url: "/Campaign/GetHistoryList?" + '&StartDate= ' + startDate + '&EndDate= ' + endDate + '&nameFilter= ' + nameFilter,
                method: "GET",
                dataType: 'html',
                success: function (data) {
                    $('#CampaignHistoryTable').html(data);
                    $("#filterStartDate").val(startDate);
                    $("#filterEndDate").val(endDate);
                    $('#filterName').val(nameFilter);

                }
            });


        }
    </script>

